<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Dashboard - SGT Palma</title>

        <!-- Bootstrap 5 -->
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
            rel="stylesheet">

        <!-- AdminLTE -->
        <link rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/admin-lte@3.2/dist/css/adminlte.min.css">

        <!-- Font Awesome -->
        <link rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

        <!-- Chart.js -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

        <!-- Nuestros estilos -->
        <link rel="stylesheet" href="/src/styles/main.css">
        <link rel="stylesheet" href="/src/styles/dashboard.css">
    </head>
    <body class="hold-transition sidebar-mini layout-fixed">
        <div class="wrapper">
            <!-- Navbar -->
            <nav
                class="main-header navbar navbar-expand navbar-white navbar-light">
                <!-- Left navbar links -->
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" data-widget="pushmenu" href="#"
                            role="button">
                            <i class="fas fa-bars"></i>
                        </a>
                    </li>
                    <li class="nav-item d-none d-sm-inline-block">
                        <a href="#" class="nav-link">Inicio</a>
                    </li>
                </ul>

                <!-- Right navbar links -->
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item dropdown">
                        <a class="nav-link" data-toggle="dropdown" href="#">
                            <i class="far fa-user mr-2"></i>
                            <span id="userName">Cargando...</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <button onclick="authService.logout()"
                            class="btn btn-danger btn-sm ml-2">
                            <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
                        </button>
                    </li>
                </ul>
            </nav>

            <!-- Sidebar -->
            <aside class="main-sidebar sidebar-dark-primary elevation-4">
                <!-- Brand Logo -->
                <a href="#" class="brand-link">
                    <i class="fas fa-seedling brand-icon mx-3"></i>
                    <span class="brand-text font-weight-light">SGT Palma</span>
                </a>

                <!-- Sidebar -->
                <div class="sidebar">
                    <!-- Sidebar user panel -->
                    <div class="user-panel mt-3 pb-3 mb-3 d-flex">
                        <div class="image">
                            <img src id="userPhoto"
                                class="img-circle elevation-2" alt="User Image"
                                onerror="this.style.display='none'">
                        </div>
                        <div class="info">
                            <a href="#" class="d-block"
                                id="sidebarUserName">Usuario</a>
                            <small class="text-light"
                                id="userRole">OPERADOR</small>
                        </div>
                    </div>

                    <!-- Sidebar Menu -->
                    <nav class="mt-2">
                        <ul class="nav nav-pills nav-sidebar flex-column"
                            data-widget="treeview" role="menu">
                            <li class="nav-item">
                                <a href="#" class="nav-link active">
                                    <i
                                        class="nav-icon fas fa-tachometer-alt"></i>
                                    <p>Dashboard</p>
                                </a>
                            </li>
                            <!-- En el sidebar menu, después del dashboard -->
                            <li class="nav-item">
                                <a href="#" class="nav-link"
                                    onclick="loadModule('empresas')">
                                    <i class="nav-icon fas fa-building"></i>
                                    <p>Empresas</p>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="#" class="nav-link"
                                    onclick="loadModule('fincas')">
                                    <i
                                        class="nav-icon fas fa-map-marked-alt"></i>
                                    <p>Fincas</p>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="#" class="nav-link">
                                    <i class="nav-icon fas fa-tractor"></i>
                                    <p>Trabajos Agrícolas</p>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="#" class="nav-link">
                                    <i
                                        class="nav-icon fas fa-map-marked-alt"></i>
                                    <p>Fincas y Lotes</p>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="#" class="nav-link">
                                    <i class="nav-icon fas fa-calendar-alt"></i>
                                    <p>Calendarización</p>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="#" class="nav-link">
                                    <i class="nav-icon fas fa-chart-bar"></i>
                                    <p>Reportes</p>
                                </a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </aside>

            <!-- Content Wrapper -->
            <div class="content-wrapper">
                <!-- Content Header -->
                <section class="content-header">
                    <div class="container-fluid">
                        <div class="row mb-2">
                            <div class="col-sm-6">
                                <h1>Dashboard</h1>
                            </div>
                            <div class="col-sm-6">
                                <ol class="breadcrumb float-sm-right">
                                    <li
                                        class="breadcrumb-item active">Dashboard</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Main content -->
                <section class="content">
                    <div class="container-fluid">
                        <!-- Small boxes (Stat boxes) -->
                        <div class="row">
                            <div class="col-lg-3 col-6">
                                <div class="small-box bg-success">
                                    <div class="inner">
                                        <h3 id="totalTrabajos">0</h3>
                                        <p>Trabajos Activos</p>
                                    </div>
                                    <div class="icon">
                                        <i class="fas fa-tractor"></i>
                                    </div>
                                    <a href="#" class="small-box-footer">Más
                                        info <i
                                            class="fas fa-arrow-circle-right"></i></a>
                                </div>
                            </div>

                            <div class="col-lg-3 col-6">
                                <div class="small-box bg-info">
                                    <div class="inner">
                                        <h3 id="totalFincas">0</h3>
                                        <p>Fincas Registradas</p>
                                    </div>
                                    <div class="icon">
                                        <i class="fas fa-map-marked-alt"></i>
                                    </div>
                                    <a href="#" class="small-box-footer">Más
                                        info <i
                                            class="fas fa-arrow-circle-right"></i></a>
                                </div>
                            </div>

                            <div class="col-lg-3 col-6">
                                <div class="small-box bg-warning">
                                    <div class="inner">
                                        <h3 id="trabajosHoy">0</h3>
                                        <p>Trabajos Hoy</p>
                                    </div>
                                    <div class="icon">
                                        <i class="fas fa-clipboard-list"></i>
                                    </div>
                                    <a href="#" class="small-box-footer">Más
                                        info <i
                                            class="fas fa-arrow-circle-right"></i></a>
                                </div>
                            </div>

                            <div class="col-lg-3 col-6">
                                <div class="small-box bg-danger">
                                    <div class="inner">
                                        <h3 id="pendientes">0</h3>
                                        <p>Pendientes</p>
                                    </div>
                                    <div class="icon">
                                        <i
                                            class="fas fa-exclamation-circle"></i>
                                    </div>
                                    <a href="#" class="small-box-footer">Más
                                        info <i
                                            class="fas fa-arrow-circle-right"></i></a>
                                </div>
                            </div>
                        </div>

                        <!-- Gráficos y contenido principal -->
                        <div class="row">
                            <!-- Gráfico de Producción -->
                            <div class="col-md-8">
                                <div class="card agri-card">
                                    <div class="card-header">
                                        <h3 class="card-title">Producción
                                            Mensual - Palma de Aceite</h3>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="produccionChart"
                                            height="250"></canvas>
                                    </div>
                                </div>
                            </div>

                            <!-- Actividad Reciente -->
                            <div class="col-md-4">
                                <div class="card agri-card">
                                    <div class="card-header">
                                        <h3 class="card-title">Actividad
                                            Reciente</h3>
                                    </div>
                                    <div class="card-body p-0">
                                        <ul
                                            class="products-list product-list-in-card pl-2 pr-2"
                                            id="actividadList">
                                            <li class="item">Cargando
                                                actividades...</li>
                                        </ul>
                                    </div>
                                </div>

                                <!-- Estado de Trabajos -->
                                <div class="card agri-card mt-3">
                                    <div class="card-header">
                                        <h3 class="card-title">Estado de
                                            Trabajos</h3>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="estadoTrabajosChart"
                                            height="200"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Tabla de Trabajos Recientes -->
                        <div class="row mt-4">
                            <div class="col-12">
                                <div class="card agri-card">
                                    <div class="card-header">
                                        <h3 class="card-title">Trabajos
                                            Recientes</h3>
                                    </div>
                                    <div class="card-body">
                                        <table
                                            class="table table-bordered table-hover">
                                            <thead>
                                                <tr>
                                                    <th>ID</th>
                                                    <th>Finca</th>
                                                    <th>Tipo Trabajo</th>
                                                    <th>Fecha</th>
                                                    <th>Estado</th>
                                                    <th>Acciones</th>
                                                </tr>
                                            </thead>
                                            <tbody id="trabajosTable">
                                                <tr>
                                                    <td colspan="6"
                                                        class="text-center">Cargando
                                                        trabajos...</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Footer -->
            <footer class="main-footer">
                <strong>Copyright &copy; 2024 SGT Palma - Sistema de Gestión
                    Agrícola.</strong>
                Todos los derechos reservados.
            </footer>
        </div>

        <!-- Scripts -->
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
        <script type="module" src="/src/dashboard.js"></script>
    </body>
</html>